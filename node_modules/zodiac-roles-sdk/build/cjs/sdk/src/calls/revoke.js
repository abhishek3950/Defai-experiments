"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.revoke = void 0;
const zodiac_roles_deployments_1 = require("zodiac-roles-deployments");
/**
 * Returns the most fine-grained calls to revoke the passed targets:
 *  - call revokeFunction for each function
 *  - call revokeTarget for each target without any functions
 */
const revoke = (targets) => {
    const calls = [];
    targets.forEach((target) => {
        if (target.clearance === zodiac_roles_deployments_1.Clearance.Target ||
            (target.clearance === zodiac_roles_deployments_1.Clearance.Function && target.functions.length === 0)) {
            calls.push({
                call: "revokeTarget",
                targetAddress: target.address,
            });
            return;
        }
        if (target.clearance === zodiac_roles_deployments_1.Clearance.Function) {
            target.functions.forEach((func) => {
                calls.push({
                    call: "revokeFunction",
                    targetAddress: target.address,
                    selector: func.selector,
                });
            });
        }
    });
    return calls;
};
exports.revoke = revoke;
